# Admin interface on the console
<VirtualHost *:443>
    ServerName insuranceandestates.flowster.io

	ServerAdmin webmaster@localhost

    # Directory permissions
    DocumentRoot /opt/flowster_clients/i_and_e/chat-widget/dist
    <Directory "/opt/flowster_clients/i_and_e/chat-widget/dist">
        AllowOverride All
        Require all granted
        Options Indexes FollowSymLinks
    </Directory>

    # Directory permissions
    Alias /static/ /opt/flowster_clients/i_and_e/website/static/
    <Directory "/opt/flowster_clients/i_and_e/website/static">
        Require all granted
    </Directory>
    
    # Enable mod_rewrite for React Router
    RewriteEngine On

    # HTTP passes
    ProxyPass /agents http://localhost:8018/agents
    ProxyPassReverse /agents http://localhost:8018/agents
    ProxyPass /admin http://localhost:8101/admin
    ProxyPassReverse /admin http://localhost:8101/admin
    
    # Handle client-side routing - redirect all requests to index.html
    # except for files that actually exist and /agents routes
    RewriteCond %{REQUEST_URI} !^/agents
    RewriteCond %{REQUEST_URI} !^/admin
    RewriteCond %{REQUEST_URI} !^/dist
    RewriteCond %{REQUEST_URI} !^/static
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteRule . /index.html [L]

    # Set proper MIME types
    <LocationMatch "\.(js|css|map)$">
        Header set Cache-Control "public, max-age=31536000"
    </LocationMatch>

    Alias /robots.txt /opt/flowster_clients/i_and_e/chat-widget/dist/robots.txt
    Alias /favicon.ico /opt/flowster_clients/i_and_e/chat-widget/dist/favicon.ico
    Alias /dist/ /opt/flowster_clients/i_and_e/chat-widget/dist/

    Include /etc/letsencrypt/options-ssl-apache.conf
    SSLCertificateFile /etc/letsencrypt/live/insuranceandestates.flowster.io/fullchain.pem
    SSLCertificateKeyFile /etc/letsencrypt/live/insuranceandestates.flowster.io/privkey.pem
</VirtualHost>



# Admin interface on the console
<VirtualHost *:443>
    ServerName blueskydev.flowster.io

	ServerAdmin webmaster@localhost

    # Directory permissions
    DocumentRoot /opt/flowster_clients/bluesky/dist
    <Directory "/opt/flowster_clients/bluesky/dist">
        AllowOverride All
        Require all granted
        Options Indexes FollowSymLinks
    </Directory>

    # Directory permissions
    Alias /static/ /opt/flowster_clients/bluesky/website/static/
    <Directory "/opt/flowster_clients/bluesky/website/static">
        Require all granted
    </Directory>
    
    # Enable mod_rewrite for React Router
    RewriteEngine On

    # HTTP passes
    ProxyPass /api http://c10:8079/api
    ProxyPassReverse /api http://c10:8079/api
    ProxyPass /admin http://c10:8078/admin
    ProxyPassReverse /admin http://c10:8078/admin
    
    # Handle client-side routing - redirect all requests to index.html
    # except for files that actually exist and /agents routes
    RewriteCond %{REQUEST_URI} !^/api
    RewriteCond %{REQUEST_URI} !^/admin
    RewriteCond %{REQUEST_URI} !^/dist
    RewriteCond %{REQUEST_URI} !^/static
    RewriteCond %{REQUEST_URI} !^/assets
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteRule . /index.html [L]

    # Set proper MIME types
    <LocationMatch "\.(js|css|map)$">
        Header set Cache-Control "public, max-age=31536000"
    </LocationMatch>

    Alias /robots.txt /opt/flowster_clients/bluesky/dist/robots.txt
    Alias /favicon.ico /opt/flowster_clients/bluesky/dist/favicon.ico
    Alias /dist/ /opt/flowster_clients/bluesky/dist/

SSLCertificateFile /etc/letsencrypt/live/blueskydev.flowster.io/fullchain.pem
SSLCertificateKeyFile /etc/letsencrypt/live/blueskydev.flowster.io/privkey.pem
Include /etc/letsencrypt/options-ssl-apache.conf
</VirtualHost>

